id: CVE-2019-0708

info:
  name: CVE-2019-0708 RDP Detection
  author: redperfect1847
  severity: critical
  description: |
    A remote code execution vulnerability exists in Remote Desktop Services formerly known as Terminal Services when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests, aka 'Remote Desktop Services Remote Code Execution Vulnerability'.
  tags: rdp,cve-2019-0708
  reference:
    - https://github.com/isabelacostaz/CVE-2019-0708-POC
    - https://github.com/hualy13/CVE-2019-0708-Check
    - https://github.com/DenuwanJayasekara/CVE-Exploitation-Reports
    - https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC
    - https://github.com/rasan2001/Microsoft-Remote-Desktop-Services-Remote-Code-Execution-Vulnerability-CVE-2019-0708

variables:
  rdp_payload: "\x03\x00\x00\x13\x0e\xe0\x00\x00\x00\x00\x00\x00\x01\x00\x08\x00\x03\x00\x00\x00"

tcp:
  - inputs:
      - data: "{{rdp_payload}}"
        type: hex
    host:
      - "{{Hostname}}"
    port: 3389
    read-size: 1024
    matchers:
      - type: word
        part: data
        words:
          - "\x03\x00\x00"
      - type: regex
        part: data
        regex:
          - "\x03\x00\x00\x13.{8}\x03\x00\x00"
    matchers-condition: and
